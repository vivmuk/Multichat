<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Venice AI - Model Explorer Dashboard</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap"
    rel="stylesheet">
  <style>
    :root {
      --primary: #0f172a;
      --primary-light: #1e293b;
      --primary-mid: #334155;
      --accent: #6366f1;
      --accent-light: #818cf8;
      --accent-bg: rgba(99, 102, 241, 0.08);
      --red: #ef4444;
      --red-bg: rgba(239, 68, 68, 0.1);
      --orange: #f97316;
      --orange-bg: rgba(249, 115, 22, 0.1);
      --amber: #f59e0b;
      --amber-bg: rgba(245, 158, 11, 0.1);
      --green: #10b981;
      --green-bg: rgba(16, 185, 129, 0.1);
      --teal: #14b8a6;
      --teal-bg: rgba(20, 184, 166, 0.1);
      --cyan: #06b6d4;
      --cyan-bg: rgba(6, 182, 212, 0.1);
      --blue: #3b82f6;
      --blue-bg: rgba(59, 130, 246, 0.1);
      --indigo: #6366f1;
      --indigo-bg: rgba(99, 102, 241, 0.1);
      --violet: #8b5cf6;
      --violet-bg: rgba(139, 92, 246, 0.1);
      --purple: #a855f7;
      --purple-bg: rgba(168, 85, 247, 0.1);
      --pink: #ec4899;
      --pink-bg: rgba(236, 72, 153, 0.1);
      --rose: #f43f5e;
      --rose-bg: rgba(244, 63, 94, 0.1);
      --background: #f8fafc;
      --surface: #ffffff;
      --surface-hover: #f1f5f9;
      --text-primary: #0f172a;
      --text-secondary: #475569;
      --text-muted: #94a3b8;
      --border: #e2e8f0;
      --border-light: #f1f5f9;
      --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.04);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.07), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.08), 0 4px 6px -4px rgba(0, 0, 0, 0.03);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.04);
      --radius-sm: 6px;
      --radius-md: 8px;
      --radius-lg: 12px;
      --radius-xl: 16px;
      --radius-full: 9999px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--background);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.5;
    }

    /* ===== TOP NAV ===== */
    .top-nav {
      background: var(--primary);
      padding: 0 32px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 100;
      border-bottom: 1px solid rgba(255,255,255,0.06);
    }
    .nav-brand {
      display: flex;
      align-items: center;
      gap: 12px;
      color: white;
    }
    .nav-brand .logo {
      width: 36px; height: 36px;
      background: linear-gradient(135deg, var(--accent) 0%, var(--violet) 100%);
      border-radius: var(--radius-md);
      display: flex; align-items: center; justify-content: center;
    }
    .nav-brand .logo .material-icons { font-size: 20px; color: white; }
    .nav-brand h1 {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 18px; font-weight: 700; letter-spacing: -0.3px;
    }
    .nav-brand span { font-size: 12px; color: rgba(255,255,255,0.5); font-weight: 400; }
    .nav-actions { display: flex; align-items: center; gap: 8px; }
    .nav-btn {
      display: flex; align-items: center; gap: 6px;
      padding: 7px 14px; border-radius: var(--radius-md);
      font-size: 13px; font-weight: 500; cursor: pointer;
      transition: all 0.15s; text-decoration: none; border: none;
    }
    .nav-btn .material-icons { font-size: 18px; }
    .nav-btn.primary { background: var(--accent); color: white; }
    .nav-btn.primary:hover { background: var(--accent-light); }
    .nav-btn.secondary {
      background: rgba(255,255,255,0.07); color: rgba(255,255,255,0.8);
      border: 1px solid rgba(255,255,255,0.1);
    }
    .nav-btn.secondary:hover { background: rgba(255,255,255,0.12); }

    /* ===== MAIN CONTAINER ===== */
    .dashboard-container { max-width: 1800px; margin: 0 auto; padding: 24px 32px; }

    /* ===== KPI ROW ===== */
    .kpi-row {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 12px;
      margin-bottom: 20px;
    }
    .kpi-card {
      background: var(--surface);
      border-radius: var(--radius-lg);
      padding: 16px 18px;
      border: 1px solid var(--border);
      position: relative;
      overflow: hidden;
      transition: all 0.2s;
    }
    .kpi-card:hover { box-shadow: var(--shadow-md); transform: translateY(-1px); }
    .kpi-card::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px;
    }
    .kpi-card.c-indigo::before { background: var(--indigo); }
    .kpi-card.c-green::before { background: var(--green); }
    .kpi-card.c-blue::before { background: var(--blue); }
    .kpi-card.c-amber::before { background: var(--amber); }
    .kpi-card.c-cyan::before { background: var(--cyan); }
    .kpi-card.c-rose::before { background: var(--rose); }
    .kpi-top { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; }
    .kpi-icon {
      width: 34px; height: 34px; border-radius: var(--radius-md);
      display: flex; align-items: center; justify-content: center;
    }
    .kpi-icon .material-icons { font-size: 18px; }
    .c-indigo .kpi-icon { background: var(--indigo-bg); color: var(--indigo); }
    .c-green .kpi-icon { background: var(--green-bg); color: var(--green); }
    .c-blue .kpi-icon { background: var(--blue-bg); color: var(--blue); }
    .c-amber .kpi-icon { background: var(--amber-bg); color: var(--amber); }
    .c-cyan .kpi-icon { background: var(--cyan-bg); color: var(--cyan); }
    .c-rose .kpi-icon { background: var(--rose-bg); color: var(--rose); }
    .kpi-value {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 22px; font-weight: 700; color: var(--text-primary); line-height: 1.2;
    }
    .kpi-label { color: var(--text-muted); font-size: 11px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.4px; }

    /* ===== SEARCH & FILTER TOOLBAR ===== */
    .toolbar {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-xl);
      padding: 20px 24px;
      margin-bottom: 16px;
      box-shadow: var(--shadow-sm);
    }
    .toolbar-top {
      display: flex; align-items: center; gap: 12px; margin-bottom: 16px;
    }
    .search-box {
      flex: 1;
      display: flex; align-items: center; gap: 10px;
      background: var(--background);
      border: 2px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 10px 16px;
      transition: all 0.2s;
    }
    .search-box:focus-within {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-bg);
      background: white;
    }
    .search-box .material-icons { font-size: 20px; color: var(--text-muted); }
    .search-box input {
      flex: 1; border: none; outline: none; background: transparent;
      font-size: 14px; font-family: inherit; color: var(--text-primary);
    }
    .search-box input::placeholder { color: var(--text-muted); }
    .search-count {
      font-size: 13px; font-weight: 600; color: var(--text-secondary);
      white-space: nowrap; padding: 8px 16px;
      background: var(--background); border-radius: var(--radius-md);
      border: 1px solid var(--border);
    }
    .search-count strong { color: var(--accent); }
    .toolbar-actions { display: flex; gap: 8px; }
    .toolbar-btn {
      display: flex; align-items: center; gap: 6px;
      padding: 8px 14px; border-radius: var(--radius-md);
      font-size: 12px; font-weight: 600; cursor: pointer;
      border: 1px solid var(--border); background: var(--surface);
      color: var(--text-secondary); transition: all 0.15s;
    }
    .toolbar-btn:hover { background: var(--background); border-color: var(--accent); color: var(--accent); }
    .toolbar-btn .material-icons { font-size: 16px; }

    /* Filter chips */
    .filter-section { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
    .filter-label {
      font-size: 11px; font-weight: 700; text-transform: uppercase;
      letter-spacing: 0.6px; color: var(--text-muted); margin-right: 2px;
      white-space: nowrap;
    }
    .filter-divider {
      width: 1px; height: 24px; background: var(--border); margin: 0 4px;
    }
    .filter-chip {
      display: inline-flex; align-items: center; gap: 5px;
      padding: 6px 12px; border-radius: var(--radius-full);
      font-size: 12px; font-weight: 600; cursor: pointer;
      border: 2px solid transparent;
      transition: all 0.15s;
      user-select: none;
    }
    .filter-chip .material-icons { font-size: 14px; }
    .filter-chip .check-icon { display: none; font-size: 13px; margin-right: -2px; }
    .filter-chip.active .check-icon { display: inline-flex; }

    /* Chip color variants */
    .chip-reasoning { background: var(--violet-bg); color: var(--violet); border-color: transparent; }
    .chip-reasoning.active { background: var(--violet); color: white; border-color: var(--violet); box-shadow: 0 2px 8px rgba(139,92,246,0.3); }
    .chip-reasoning:hover:not(.active) { border-color: var(--violet); }

    .chip-vision { background: var(--blue-bg); color: var(--blue); border-color: transparent; }
    .chip-vision.active { background: var(--blue); color: white; border-color: var(--blue); box-shadow: 0 2px 8px rgba(59,130,246,0.3); }
    .chip-vision:hover:not(.active) { border-color: var(--blue); }

    .chip-code { background: var(--green-bg); color: var(--green); border-color: transparent; }
    .chip-code.active { background: var(--green); color: white; border-color: var(--green); box-shadow: 0 2px 8px rgba(16,185,129,0.3); }
    .chip-code:hover:not(.active) { border-color: var(--green); }

    .chip-websearch { background: var(--cyan-bg); color: var(--cyan); border-color: transparent; }
    .chip-websearch.active { background: var(--cyan); color: white; border-color: var(--cyan); box-shadow: 0 2px 8px rgba(6,182,212,0.3); }
    .chip-websearch:hover:not(.active) { border-color: var(--cyan); }

    .chip-functions { background: var(--orange-bg); color: var(--orange); border-color: transparent; }
    .chip-functions.active { background: var(--orange); color: white; border-color: var(--orange); box-shadow: 0 2px 8px rgba(249,115,22,0.3); }
    .chip-functions:hover:not(.active) { border-color: var(--orange); }

    .chip-schema { background: var(--pink-bg); color: var(--pink); border-color: transparent; }
    .chip-schema.active { background: var(--pink); color: white; border-color: var(--pink); box-shadow: 0 2px 8px rgba(236,72,153,0.3); }
    .chip-schema:hover:not(.active) { border-color: var(--pink); }

    .chip-beta { background: var(--amber-bg); color: var(--amber); border-color: transparent; }
    .chip-beta.active { background: var(--amber); color: white; border-color: var(--amber); box-shadow: 0 2px 8px rgba(245,158,11,0.3); }
    .chip-beta:hover:not(.active) { border-color: var(--amber); }

    .clear-filters {
      display: inline-flex; align-items: center; gap: 4px;
      padding: 5px 10px; border-radius: var(--radius-full);
      font-size: 11px; font-weight: 600; cursor: pointer;
      border: 1px dashed var(--border); background: transparent;
      color: var(--text-muted); transition: all 0.15s;
    }
    .clear-filters:hover { border-color: var(--red); color: var(--red); background: var(--red-bg); }
    .clear-filters .material-icons { font-size: 14px; }

    /* ===== MODEL TABLE ===== */
    .table-container {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-xl);
      overflow: hidden;
      box-shadow: var(--shadow-sm);
      margin-bottom: 24px;
    }
    .table-scroll {
      overflow-x: auto;
      max-height: calc(100vh - 360px);
      overflow-y: auto;
    }
    .model-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }
    .model-table thead { position: sticky; top: 0; z-index: 10; }
    .model-table thead tr { background: var(--primary); }
    .model-table th {
      padding: 12px 14px;
      text-align: left;
      font-size: 11px;
      font-weight: 700;
      color: rgba(255,255,255,0.7);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      white-space: nowrap;
      cursor: pointer;
      transition: all 0.15s;
      border-bottom: none;
      user-select: none;
      position: relative;
    }
    .model-table th:hover { color: white; background: rgba(255,255,255,0.05); }
    .model-table th .sort-arrow {
      display: inline-block; margin-left: 4px; font-size: 12px; opacity: 0.3;
      vertical-align: middle;
    }
    .model-table th.sort-active .sort-arrow { opacity: 1; color: var(--accent-light); }
    .model-table th.sort-active { color: white; }
    .model-table td {
      padding: 10px 14px;
      border-bottom: 1px solid var(--border-light);
      vertical-align: middle;
      color: var(--text-primary);
    }
    .model-table tbody tr {
      transition: background 0.1s;
    }
    .model-table tbody tr:hover {
      background: var(--accent-bg);
    }
    .model-table tbody tr:last-child td { border-bottom: none; }

    /* Table cells */
    .cell-model {
      display: flex; align-items: center; gap: 10px; min-width: 220px;
    }
    .model-avatar {
      width: 32px; height: 32px; border-radius: var(--radius-sm);
      display: flex; align-items: center; justify-content: center;
      font-size: 11px; font-weight: 700; color: white; flex-shrink: 0;
      background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary-mid) 100%);
    }
    .model-avatar.reasoning { background: linear-gradient(135deg, var(--violet) 0%, var(--purple) 100%); }
    .model-avatar.vision { background: linear-gradient(135deg, var(--blue) 0%, var(--cyan) 100%); }
    .model-avatar.code { background: linear-gradient(135deg, var(--green) 0%, var(--teal) 100%); }
    .cell-model-info { min-width: 0; }
    .cell-model-name {
      font-weight: 600; color: var(--text-primary); font-size: 13px;
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 240px;
    }
    .cell-model-sub {
      font-size: 11px; color: var(--text-muted);
      display: flex; align-items: center; gap: 6px;
    }
    .cell-model-sub .beta-tag {
      display: inline-flex; padding: 1px 6px; border-radius: var(--radius-full);
      background: var(--amber-bg); color: var(--amber); font-size: 9px; font-weight: 700;
      text-transform: uppercase; letter-spacing: 0.3px;
    }
    .cell-number {
      font-family: 'JetBrains Mono', 'Space Grotesk', monospace;
      font-size: 12px; font-weight: 500; white-space: nowrap; text-align: right;
    }
    .cell-price { font-weight: 600; }
    .price-free { color: var(--green); }
    .price-low { color: var(--teal); }
    .price-mid { color: var(--amber); }
    .price-high { color: var(--orange); }
    .price-premium { color: var(--red); }

    .cell-tokens { color: var(--text-primary); }
    .cell-context { color: var(--indigo); font-weight: 600; }

    /* Capability dots in table */
    .cap-dots { display: flex; gap: 4px; flex-wrap: wrap; }
    .cap-dot {
      display: inline-flex; align-items: center; gap: 3px;
      padding: 2px 7px; border-radius: var(--radius-full);
      font-size: 10px; font-weight: 600; white-space: nowrap;
    }
    .cap-dot .material-icons { font-size: 11px; }
    .dot-reasoning { background: var(--violet-bg); color: var(--violet); }
    .dot-vision { background: var(--blue-bg); color: var(--blue); }
    .dot-code { background: var(--green-bg); color: var(--green); }
    .dot-websearch { background: var(--cyan-bg); color: var(--cyan); }
    .dot-functions { background: var(--orange-bg); color: var(--orange); }
    .dot-schema { background: var(--pink-bg); color: var(--pink); }

    /* ===== RATE LIMITS (compact) ===== */
    .rate-row {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      margin-bottom: 20px;
    }
    .rate-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 14px 16px;
      display: flex; align-items: center; gap: 12px;
    }
    .rate-icon {
      width: 36px; height: 36px; border-radius: var(--radius-md);
      background: var(--primary);
      display: flex; align-items: center; justify-content: center; flex-shrink: 0;
    }
    .rate-icon .material-icons { color: rgba(255,255,255,0.8); font-size: 18px; }
    .rate-info {}
    .rate-value {
      font-family: 'Space Grotesk'; font-size: 18px; font-weight: 700;
      color: var(--text-primary); line-height: 1.2;
    }
    .rate-label { font-size: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.4px; font-weight: 600; }

    /* ===== COLLAPSIBLE SECTIONS ===== */
    .collapsible-section {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius-xl);
      margin-bottom: 16px;
      overflow: hidden;
    }
    .collapsible-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 16px 20px; cursor: pointer; transition: background 0.15s;
      user-select: none;
    }
    .collapsible-header:hover { background: var(--surface-hover); }
    .collapsible-header h3 {
      font-family: 'Space Grotesk';
      font-size: 16px; font-weight: 600; color: var(--text-primary);
      display: flex; align-items: center; gap: 10px;
    }
    .collapsible-header h3 .material-icons { font-size: 22px; color: var(--accent); }
    .collapsible-header .toggle-icon {
      transition: transform 0.25s; color: var(--text-muted); font-size: 24px;
    }
    .collapsible-header.open .toggle-icon { transform: rotate(180deg); }
    .collapsible-body { display: none; padding: 0 20px 20px 20px; }
    .collapsible-body.open { display: block; }

    /* Static pricing tables */
    .static-tables-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
    }
    .static-table-card {
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      overflow: hidden;
    }
    .static-table-head {
      padding: 14px 16px;
      font-size: 14px; font-weight: 600;
      display: flex; align-items: center; gap: 8px;
    }
    .static-table-head .material-icons { font-size: 18px; }
    .head-image { background: var(--blue-bg); color: var(--blue); }
    .head-edit { background: var(--purple-bg); color: var(--purple); }
    .head-audio { background: var(--green-bg); color: var(--green); }
    .static-table {
      width: 100%; border-collapse: collapse; font-size: 12px;
    }
    .static-table th {
      padding: 8px 12px; text-align: left;
      font-size: 10px; font-weight: 700; text-transform: uppercase;
      letter-spacing: 0.4px; color: var(--text-muted);
      background: var(--background); border-top: 1px solid var(--border-light);
    }
    .static-table td {
      padding: 9px 12px; border-top: 1px solid var(--border-light);
      font-size: 12px;
    }
    .static-table .s-name { font-weight: 600; }
    .static-table .s-price { font-family: 'JetBrains Mono'; font-weight: 600; }
    .static-table .s-price.low { color: var(--green); }
    .static-table .s-price.mid { color: var(--amber); }
    .static-table .s-price.high { color: var(--orange); }

    /* ===== DETAIL PANEL (row expand) ===== */
    .detail-row td { padding: 0 !important; background: var(--background) !important; }
    .detail-panel {
      padding: 16px 20px;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
    }
    .detail-card {
      background: var(--surface);
      border-radius: var(--radius-lg);
      padding: 14px 16px;
      border: 1px solid var(--border);
    }
    .detail-card h5 {
      font-size: 10px; font-weight: 700; text-transform: uppercase;
      letter-spacing: 0.5px; color: var(--text-muted); margin-bottom: 8px;
    }
    .detail-stat {
      display: flex; justify-content: space-between; align-items: center;
      padding: 3px 0; font-size: 12px;
    }
    .detail-stat-label { color: var(--text-secondary); }
    .detail-stat-value { font-family: 'JetBrains Mono'; font-weight: 600; font-size: 12px; }

    /* ===== EMPTY STATE ===== */
    .empty-state {
      text-align: center; padding: 60px 20px; color: var(--text-muted);
    }
    .empty-state .material-icons { font-size: 48px; color: var(--border); margin-bottom: 12px; }
    .empty-state h3 { font-size: 16px; color: var(--text-secondary); margin-bottom: 4px; }
    .empty-state p { font-size: 13px; }

    /* ===== LOADING ===== */
    .loading-overlay {
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(248,250,252,0.97);
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      z-index: 1000;
    }
    .loading-spinner {
      width: 40px; height: 40px;
      border: 3px solid var(--border);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }
    .loading-text { margin-top: 12px; color: var(--text-secondary); font-weight: 500; font-size: 14px; }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* ===== FOOTER ===== */
    .dashboard-footer {
      text-align: center; padding: 24px; color: var(--text-muted); font-size: 12px;
    }
    .dashboard-footer a { color: var(--accent); text-decoration: none; }
    .dashboard-footer a:hover { text-decoration: underline; }

    /* ===== RESPONSIVE ===== */
    @media (max-width: 1400px) {
      .kpi-row { grid-template-columns: repeat(3, 1fr); }
      .static-tables-grid { grid-template-columns: 1fr 1fr; }
      .detail-panel { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 1000px) {
      .dashboard-container { padding: 16px; }
      .kpi-row { grid-template-columns: repeat(2, 1fr); }
      .rate-row { grid-template-columns: repeat(2, 1fr); }
      .static-tables-grid { grid-template-columns: 1fr; }
      .detail-panel { grid-template-columns: 1fr 1fr; }
    }
    @media (max-width: 768px) {
      .top-nav { padding: 0 16px; }
      .kpi-row { grid-template-columns: 1fr; }
      .rate-row { grid-template-columns: 1fr; }
      .detail-panel { grid-template-columns: 1fr; }
      .nav-btn span:not(.material-icons) { display: none; }
      .toolbar-top { flex-wrap: wrap; }
      .filter-section { flex-wrap: wrap; }
      .table-scroll { max-height: none; }
    }

    /* ===== SCROLLBAR ===== */
    .table-scroll::-webkit-scrollbar { width: 6px; height: 6px; }
    .table-scroll::-webkit-scrollbar-track { background: var(--background); }
    .table-scroll::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
    .table-scroll::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }

    /* Tooltip */
    [data-tooltip] { position: relative; }
    [data-tooltip]:hover::after {
      content: attr(data-tooltip);
      position: absolute; bottom: calc(100% + 6px); left: 50%; transform: translateX(-50%);
      background: var(--primary); color: white; font-size: 11px; font-weight: 500;
      padding: 4px 10px; border-radius: var(--radius-sm); white-space: nowrap;
      z-index: 20; pointer-events: none;
    }

    /* Row highlight for best value */
    .row-best-value { background: rgba(16, 185, 129, 0.04); }
    .row-best-value:hover { background: rgba(16, 185, 129, 0.08) !important; }
    .best-value-badge {
      display: inline-flex; align-items: center; gap: 3px;
      padding: 1px 6px; border-radius: var(--radius-full);
      background: var(--green-bg); color: var(--green);
      font-size: 9px; font-weight: 700; text-transform: uppercase;
    }
    .best-value-badge .material-icons { font-size: 10px; }
  </style>
</head>

<body>
  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner"></div>
    <div class="loading-text">Loading Venice AI Models...</div>
  </div>

  <!-- Top Navigation -->
  <nav class="top-nav">
    <div class="nav-brand">
      <div class="logo">
        <span class="material-icons">hub</span>
      </div>
      <div>
        <h1>Venice AI</h1>
        <span>Model Explorer</span>
      </div>
    </div>
    <div class="nav-actions">
      <button class="nav-btn secondary" onclick="exportCSV()" title="Export as CSV">
        <span class="material-icons">download</span>
        <span>Export</span>
      </button>
      <button class="nav-btn secondary" onclick="refreshData()">
        <span class="material-icons">refresh</span>
        <span>Refresh</span>
      </button>
      <a href="index.html" class="nav-btn primary">
        <span class="material-icons">chat</span>
        <span>Back to Chat</span>
      </a>
      <button class="nav-btn secondary" onclick="logout()" title="Sign out">
        <span class="material-icons">logout</span>
      </button>
    </div>
  </nav>

  <!-- Main Container -->
  <div class="dashboard-container">

    <!-- KPI Row -->
    <div class="kpi-row">
      <div class="kpi-card c-indigo">
        <div class="kpi-top">
          <div class="kpi-icon"><span class="material-icons">smart_toy</span></div>
        </div>
        <div class="kpi-value" id="totalModels">--</div>
        <div class="kpi-label">Total Models</div>
      </div>
      <div class="kpi-card c-green">
        <div class="kpi-top">
          <div class="kpi-icon"><span class="material-icons">speed</span></div>
        </div>
        <div class="kpi-value" id="maxInputTokens">--</div>
        <div class="kpi-label">Max Input Tokens @ $48</div>
      </div>
      <div class="kpi-card c-blue">
        <div class="kpi-top">
          <div class="kpi-icon"><span class="material-icons">output</span></div>
        </div>
        <div class="kpi-value" id="maxOutputTokens">--</div>
        <div class="kpi-label">Max Output Tokens @ $48</div>
      </div>
      <div class="kpi-card c-amber">
        <div class="kpi-top">
          <div class="kpi-icon"><span class="material-icons">savings</span></div>
        </div>
        <div class="kpi-value" id="avgCost">--</div>
        <div class="kpi-label">Avg Cost / 1M Tokens</div>
      </div>
      <div class="kpi-card c-cyan">
        <div class="kpi-top">
          <div class="kpi-icon"><span class="material-icons">token</span></div>
        </div>
        <div class="kpi-value" id="maxContext">--</div>
        <div class="kpi-label">Largest Context Window</div>
      </div>
      <div class="kpi-card c-rose">
        <div class="kpi-top">
          <div class="kpi-icon"><span class="material-icons">workspace_premium</span></div>
        </div>
        <div class="kpi-value" id="bestValue">--</div>
        <div class="kpi-label">Best Value Model</div>
      </div>
    </div>

    <!-- Rate Limits -->
    <div class="rate-row" id="rateLimitsRow">
      <div class="rate-card">
        <div class="rate-icon"><span class="material-icons">bolt</span></div>
        <div class="rate-info">
          <div class="rate-value" id="rpmLimit">--</div>
          <div class="rate-label">Requests / Min</div>
        </div>
      </div>
      <div class="rate-card">
        <div class="rate-icon"><span class="material-icons">data_usage</span></div>
        <div class="rate-info">
          <div class="rate-value" id="tpmLimit">--</div>
          <div class="rate-label">Tokens / Min</div>
        </div>
      </div>
      <div class="rate-card">
        <div class="rate-icon"><span class="material-icons">today</span></div>
        <div class="rate-info">
          <div class="rate-value" id="rpdLimit">--</div>
          <div class="rate-label">Requests / Day</div>
        </div>
      </div>
      <div class="rate-card">
        <div class="rate-icon"><span class="material-icons">calendar_month</span></div>
        <div class="rate-info">
          <div class="rate-value" id="tpdLimit">--</div>
          <div class="rate-label">Tokens / Day</div>
        </div>
      </div>
    </div>

    <!-- Search & Filter Toolbar -->
    <div class="toolbar">
      <div class="toolbar-top">
        <div class="search-box">
          <span class="material-icons">search</span>
          <input type="text" id="searchInput" placeholder="Search models by name (e.g. qwen, llama, deepseek, gemma...)" oninput="applyFilters()">
        </div>
        <div class="search-count" id="searchCount">
          Showing <strong>0</strong> of <strong>0</strong> models
        </div>
      </div>
      <div class="filter-section">
        <span class="filter-label">Capabilities:</span>
        <button class="filter-chip chip-reasoning" data-filter="reasoning" onclick="toggleFilter(this)">
          <span class="material-icons check-icon">check</span>
          <span class="material-icons">psychology</span> Reasoning
        </button>
        <button class="filter-chip chip-vision" data-filter="vision" onclick="toggleFilter(this)">
          <span class="material-icons check-icon">check</span>
          <span class="material-icons">visibility</span> Vision
        </button>
        <button class="filter-chip chip-code" data-filter="code" onclick="toggleFilter(this)">
          <span class="material-icons check-icon">check</span>
          <span class="material-icons">code</span> Code
        </button>
        <button class="filter-chip chip-websearch" data-filter="websearch" onclick="toggleFilter(this)">
          <span class="material-icons check-icon">check</span>
          <span class="material-icons">travel_explore</span> Web Search
        </button>
        <button class="filter-chip chip-functions" data-filter="functions" onclick="toggleFilter(this)">
          <span class="material-icons check-icon">check</span>
          <span class="material-icons">functions</span> Functions
        </button>
        <button class="filter-chip chip-schema" data-filter="schema" onclick="toggleFilter(this)">
          <span class="material-icons check-icon">check</span>
          <span class="material-icons">schema</span> JSON Schema
        </button>
        <div class="filter-divider"></div>
        <button class="filter-chip chip-beta" data-filter="beta" onclick="toggleFilter(this)">
          <span class="material-icons check-icon">check</span>
          <span class="material-icons">science</span> Beta Only
        </button>
        <button class="clear-filters" onclick="clearFilters()" id="clearFiltersBtn" style="display:none;">
          <span class="material-icons">close</span> Clear All
        </button>
      </div>
    </div>

    <!-- Main Model Table -->
    <div class="table-container">
      <div class="table-scroll">
        <table class="model-table" id="modelTable">
          <thead>
            <tr>
              <th onclick="sortBy('name')" style="min-width:240px;">
                Model <span class="sort-arrow" id="sort-name">&#8597;</span>
              </th>
              <th onclick="sortBy('context')" style="text-align:right;">
                Context <span class="sort-arrow" id="sort-context">&#8597;</span>
              </th>
              <th onclick="sortBy('maxOutput')" style="text-align:right;">
                Max Output <span class="sort-arrow" id="sort-maxOutput">&#8597;</span>
              </th>
              <th onclick="sortBy('inputPrice')" style="text-align:right;">
                Input $/1M <span class="sort-arrow" id="sort-inputPrice">&#8597;</span>
              </th>
              <th onclick="sortBy('outputPrice')" style="text-align:right;">
                Output $/1M <span class="sort-arrow" id="sort-outputPrice">&#8597;</span>
              </th>
              <th onclick="sortBy('budgetTokens')" style="text-align:right;">
                Tokens @ $48 <span class="sort-arrow" id="sort-budgetTokens">&#8597;</span>
              </th>
              <th style="min-width:200px;">
                Capabilities
              </th>
            </tr>
          </thead>
          <tbody id="modelTableBody">
          </tbody>
        </table>
      </div>
    </div>

    <!-- Static Pricing (collapsible) -->
    <div class="collapsible-section">
      <div class="collapsible-header" onclick="toggleCollapsible(this)">
        <h3><span class="material-icons">palette</span> Image, Editing & Audio Pricing</h3>
        <span class="material-icons toggle-icon">expand_more</span>
      </div>
      <div class="collapsible-body">
        <div class="static-tables-grid">
          <!-- Image Models -->
          <div class="static-table-card">
            <div class="static-table-head head-image">
              <span class="material-icons">image</span> Image Generation
            </div>
            <table class="static-table">
              <thead><tr><th>Model</th><th>Price/Gen</th><th>Max @ $48</th></tr></thead>
              <tbody>
                <tr><td class="s-name">Nano Banana Pro</td><td class="s-price high">$0.18</td><td>266</td></tr>
                <tr><td class="s-name">Venice SD35</td><td class="s-price low">$0.01</td><td>4,800</td></tr>
                <tr><td class="s-name">HiDream</td><td class="s-price low">$0.01</td><td>4,800</td></tr>
                <tr><td class="s-name">Qwen Image</td><td class="s-price low">$0.01</td><td>4,800</td></tr>
                <tr><td class="s-name">Lustify (SDXL/v7)</td><td class="s-price low">$0.01</td><td>4,800</td></tr>
                <tr><td class="s-name">Anime (WAI)</td><td class="s-price low">$0.01</td><td>4,800</td></tr>
              </tbody>
            </table>
          </div>
          <!-- Image Editing -->
          <div class="static-table-card">
            <div class="static-table-head head-edit">
              <span class="material-icons">auto_fix_high</span> Image Editing / Upscaling
            </div>
            <table class="static-table">
              <thead><tr><th>Task</th><th>Price</th><th>Max @ $48</th></tr></thead>
              <tbody>
                <tr><td class="s-name">Upscale 2x</td><td class="s-price low">$0.02</td><td>2,400</td></tr>
                <tr><td class="s-name">Upscale 4x</td><td class="s-price mid">$0.08</td><td>600</td></tr>
                <tr><td class="s-name">Image Editing</td><td class="s-price mid">$0.04</td><td>1,200</td></tr>
              </tbody>
            </table>
          </div>
          <!-- Audio Models -->
          <div class="static-table-card">
            <div class="static-table-head head-audio">
              <span class="material-icons">record_voice_over</span> Audio Models
            </div>
            <table class="static-table">
              <thead><tr><th>Model</th><th>Price/1M Chars</th><th>Max @ $48</th></tr></thead>
              <tbody>
                <tr><td class="s-name">Kokoro TTS</td><td class="s-price low">$3.50</td><td>13.7M chars</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="dashboard-footer">
      <p>Real-time data from <a href="https://venice.ai" target="_blank">Venice AI</a> API &middot; Prices reflect latest API response &middot; 48 Diem = $48 Compute Budget</p>
    </div>
  </div>

  <!-- API key will be injected by build script from Netlify environment variable -->
  <script src="config.js"
    onerror="console.warn('config.js not found. Using build-injected API key if available.')"></script>
  <script>
    // ===== CONSTANTS =====
    const DIEM_BUDGET = 48;
    const BASE_URL = 'https://api.venice.ai/api/v1';

    // ===== STATE =====
    let availableModels = [];
    let filteredModels = [];
    let activeFilters = new Set();
    let currentSort = { column: 'name', direction: 'asc' };
    let expandedRow = null;

    // Best value model IDs (top 3, computed after load)
    let bestValueIds = new Set();

    // ===== API KEY =====
    function getApiKey() {
      if (window.VENICE_API_KEY && window.VENICE_API_KEY !== 'your-venice-api-key-here') {
        return window.VENICE_API_KEY;
      }
      return localStorage.getItem('venice_backend_api_key') || '';
    }

    // ===== UTILITIES =====
    function formatTokens(tokens) {
      if (tokens >= 1000000000) return (tokens / 1000000000).toFixed(1) + 'B';
      if (tokens >= 1000000) return (tokens / 1000000).toFixed(1) + 'M';
      if (tokens >= 1000) return (tokens / 1000).toFixed(0) + 'K';
      return tokens.toLocaleString();
    }

    function getInitials(id) {
      const clean = id.replace(/[^a-zA-Z0-9]+/g, ' ').trim();
      const parts = clean.split(' ').filter(Boolean);
      if (parts.length >= 2) return (parts[0][0] + parts[1][0]).toUpperCase();
      return clean.slice(0, 2).toUpperCase();
    }

    function getPriceClass(price) {
      if (price <= 0) return 'price-free';
      if (price <= 0.3) return 'price-low';
      if (price <= 1.5) return 'price-mid';
      if (price <= 5) return 'price-high';
      return 'price-premium';
    }

    function getAvatarClass(model) {
      const caps = model.model_spec?.capabilities || {};
      if (caps.supportsReasoning) return 'reasoning';
      if (caps.supportsVision) return 'vision';
      if (caps.optimizedForCode) return 'code';
      return '';
    }

    function getModelData(model) {
      const spec = model.model_spec || {};
      const pricing = spec.pricing || {};
      const caps = spec.capabilities || {};
      const inputPrice = pricing.input?.usd || 0;
      const outputPrice = pricing.output?.usd || 0;
      const contextTokens = spec.availableContextTokens || 0;
      const maxOutputTokens = spec.maxCompletionTokens || Math.floor(contextTokens * 0.25);
      const budgetTokens = outputPrice > 0 ? (DIEM_BUDGET / outputPrice) * 1000000 : 0;

      return {
        id: model.id,
        name: model.id,
        contextTokens,
        maxOutputTokens,
        inputPrice,
        outputPrice,
        budgetTokens,
        reasoning: !!caps.supportsReasoning,
        vision: !!caps.supportsVision,
        code: !!caps.optimizedForCode,
        websearch: !!caps.supportsWebSearch,
        functions: !!caps.supportsFunctionCalling,
        schema: !!caps.supportsResponseSchema,
        beta: !!spec.beta,
        traits: spec.traits || [],
        model: model
      };
    }

    // ===== FETCH MODELS =====
    async function fetchModels() {
      const apiKey = getApiKey();
      if (!apiKey) {
        document.getElementById('loadingOverlay').innerHTML = `
          <div style="text-align:center;padding:40px;">
            <span class="material-icons" style="font-size:56px;color:var(--accent);">vpn_key</span>
            <h2 style="margin:16px 0 8px;">API Key Not Configured</h2>
            <p style="color:var(--text-secondary);margin-bottom:20px;">Please check your deployment or config settings.</p>
            <a href="index.html" class="nav-btn primary" style="display:inline-flex;">
              <span class="material-icons">arrow_back</span> <span>Go to Chat</span>
            </a>
          </div>`;
        return;
      }

      try {
        const response = await fetch(`${BASE_URL}/models?type=text`, {
          headers: { 'Authorization': `Bearer ${apiKey}` }
        });
        if (!response.ok) throw new Error(`API Error: ${response.status}`);

        const data = await response.json();
        availableModels = (data.data || [])
          .filter(m => m.type === 'text' && m.model_spec?.offline !== true)
          .filter(m => !m.id.toLowerCase().includes('coder') || m.id.toLowerCase().includes('qwen'))
          .sort((a, b) => {
            const aR = a.model_spec?.traits?.includes('default_reasoning') ? 1 : 0;
            const bR = b.model_spec?.traits?.includes('default_reasoning') ? 1 : 0;
            if (aR !== bR) return bR - aR;
            return (b.model_spec?.availableContextTokens || 0) - (a.model_spec?.availableContextTokens || 0);
          });

        // Compute best value models (top 3 by budget tokens)
        const sorted = availableModels
          .map(m => ({ id: m.id, bt: getModelData(m).budgetTokens }))
          .filter(x => x.bt > 0)
          .sort((a, b) => b.bt - a.bt);
        bestValueIds = new Set(sorted.slice(0, 3).map(x => x.id));

        renderAll();
        document.getElementById('loadingOverlay').style.display = 'none';
      } catch (error) {
        console.error('Failed to fetch models:', error);
        document.getElementById('loadingOverlay').innerHTML = `
          <div style="text-align:center;padding:40px;">
            <span class="material-icons" style="font-size:56px;color:var(--red);">error</span>
            <h2 style="margin:16px 0 8px;">Failed to Load Models</h2>
            <p style="color:var(--text-secondary);margin-bottom:20px;">${error.message}</p>
            <button onclick="location.reload()" class="nav-btn primary" style="display:inline-flex;">
              <span class="material-icons">refresh</span> <span>Retry</span>
            </button>
          </div>`;
      }
    }

    // ===== RENDER ALL =====
    function renderAll() {
      updateKPIs();
      applyFilters();
      fetchRateLimits();
    }

    // ===== KPIs =====
    function updateKPIs() {
      document.getElementById('totalModels').textContent = availableModels.length;

      let maxInput = 0, maxOutput = 0, totalCost = 0, costCount = 0, maxCtx = 0;
      let bestModel = '--';
      let bestBudget = 0;

      availableModels.forEach(model => {
        const d = getModelData(model);
        if (d.inputPrice > 0) {
          const it = (DIEM_BUDGET / d.inputPrice) * 1000000;
          if (it > maxInput) maxInput = it;
          totalCost += d.inputPrice;
          costCount++;
        }
        if (d.outputPrice > 0) {
          const ot = (DIEM_BUDGET / d.outputPrice) * 1000000;
          if (ot > maxOutput) maxOutput = ot;
          totalCost += d.outputPrice;
        }
        if (d.contextTokens > maxCtx) maxCtx = d.contextTokens;
        if (d.budgetTokens > bestBudget) {
          bestBudget = d.budgetTokens;
          bestModel = d.name.split('-').slice(0, 2).join('-');
        }
      });

      document.getElementById('maxInputTokens').textContent = formatTokens(maxInput);
      document.getElementById('maxOutputTokens').textContent = formatTokens(maxOutput);
      document.getElementById('maxContext').textContent = formatTokens(maxCtx);
      document.getElementById('bestValue').textContent = bestModel;

      const avg = costCount > 0 ? (totalCost / (costCount * 2)).toFixed(2) : '--';
      document.getElementById('avgCost').textContent = '$' + avg;
    }

    // ===== FILTERS =====
    function toggleFilter(btn) {
      const filter = btn.dataset.filter;
      if (activeFilters.has(filter)) {
        activeFilters.delete(filter);
        btn.classList.remove('active');
      } else {
        activeFilters.add(filter);
        btn.classList.add('active');
      }
      document.getElementById('clearFiltersBtn').style.display = activeFilters.size > 0 ? 'inline-flex' : 'none';
      applyFilters();
    }

    function clearFilters() {
      activeFilters.clear();
      document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
      document.getElementById('clearFiltersBtn').style.display = 'none';
      document.getElementById('searchInput').value = '';
      applyFilters();
    }

    function applyFilters() {
      const search = (document.getElementById('searchInput')?.value || '').trim().toLowerCase();

      filteredModels = availableModels.filter(model => {
        const d = getModelData(model);

        // Search filter
        if (search && !d.name.toLowerCase().includes(search)) return false;

        // Capability filters (AND logic - model must have ALL selected capabilities)
        for (const f of activeFilters) {
          if (f === 'reasoning' && !d.reasoning) return false;
          if (f === 'vision' && !d.vision) return false;
          if (f === 'code' && !d.code) return false;
          if (f === 'websearch' && !d.websearch) return false;
          if (f === 'functions' && !d.functions) return false;
          if (f === 'schema' && !d.schema) return false;
          if (f === 'beta' && !d.beta) return false;
        }

        return true;
      });

      renderTable();
      updateSearchCount();
    }

    function updateSearchCount() {
      document.getElementById('searchCount').innerHTML =
        `Showing <strong>${filteredModels.length}</strong> of <strong>${availableModels.length}</strong> models`;
    }

    // ===== SORTING =====
    function sortBy(column) {
      if (currentSort.column === column) {
        currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
      } else {
        currentSort.column = column;
        currentSort.direction = column === 'name' ? 'asc' : 'desc';
      }
      renderTable();
    }

    function getSortedModels() {
      const models = [...filteredModels];
      const { column, direction } = currentSort;
      const mult = direction === 'asc' ? 1 : -1;

      models.sort((a, b) => {
        const da = getModelData(a);
        const db = getModelData(b);
        let av, bv;

        switch (column) {
          case 'name': av = da.name.toLowerCase(); bv = db.name.toLowerCase();
            return mult * av.localeCompare(bv);
          case 'context': av = da.contextTokens; bv = db.contextTokens; break;
          case 'maxOutput': av = da.maxOutputTokens; bv = db.maxOutputTokens; break;
          case 'inputPrice': av = da.inputPrice; bv = db.inputPrice; break;
          case 'outputPrice': av = da.outputPrice; bv = db.outputPrice; break;
          case 'budgetTokens': av = da.budgetTokens; bv = db.budgetTokens; break;
          default: return 0;
        }
        return mult * (av - bv);
      });
      return models;
    }

    // ===== RENDER TABLE =====
    function renderTable() {
      const tbody = document.getElementById('modelTableBody');
      const sorted = getSortedModels();

      // Update sort arrows
      document.querySelectorAll('.model-table th').forEach(th => th.classList.remove('sort-active'));
      document.querySelectorAll('.sort-arrow').forEach(el => { el.innerHTML = '&#8597;'; });
      const activeArrow = document.getElementById('sort-' + currentSort.column);
      if (activeArrow) {
        activeArrow.parentElement.classList.add('sort-active');
        activeArrow.innerHTML = currentSort.direction === 'asc' ? '&#8593;' : '&#8595;';
      }

      if (sorted.length === 0) {
        tbody.innerHTML = `
          <tr><td colspan="7">
            <div class="empty-state">
              <span class="material-icons">search_off</span>
              <h3>No models match your filters</h3>
              <p>Try adjusting your search or removing some filters</p>
            </div>
          </td></tr>`;
        return;
      }

      tbody.innerHTML = sorted.map(model => {
        const d = getModelData(model);
        const isBestValue = bestValueIds.has(d.id);
        const rowClass = isBestValue ? 'row-best-value' : '';

        // Build capability badges
        let caps = '';
        if (d.reasoning) caps += '<span class="cap-dot dot-reasoning"><span class="material-icons">psychology</span>Reasoning</span>';
        if (d.vision) caps += '<span class="cap-dot dot-vision"><span class="material-icons">visibility</span>Vision</span>';
        if (d.code) caps += '<span class="cap-dot dot-code"><span class="material-icons">code</span>Code</span>';
        if (d.websearch) caps += '<span class="cap-dot dot-websearch"><span class="material-icons">travel_explore</span>Web</span>';
        if (d.functions) caps += '<span class="cap-dot dot-functions"><span class="material-icons">functions</span>Func</span>';
        if (d.schema) caps += '<span class="cap-dot dot-schema"><span class="material-icons">schema</span>JSON</span>';

        const betaTag = d.beta ? '<span class="beta-tag">BETA</span>' : '';
        const bestTag = isBestValue ? ' <span class="best-value-badge"><span class="material-icons">star</span>Best Value</span>' : '';

        return `
          <tr class="${rowClass}" onclick="toggleDetail('${d.id}')" style="cursor:pointer;">
            <td>
              <div class="cell-model">
                <div class="model-avatar ${getAvatarClass(model)}">${getInitials(d.id)}</div>
                <div class="cell-model-info">
                  <div class="cell-model-name">${d.name}${bestTag}</div>
                  <div class="cell-model-sub">${betaTag}</div>
                </div>
              </div>
            </td>
            <td class="cell-number cell-context">${formatTokens(d.contextTokens)}</td>
            <td class="cell-number cell-tokens">${formatTokens(d.maxOutputTokens)}</td>
            <td class="cell-number cell-price ${getPriceClass(d.inputPrice)}">$${d.inputPrice.toFixed(2)}</td>
            <td class="cell-number cell-price ${getPriceClass(d.outputPrice)}">$${d.outputPrice.toFixed(2)}</td>
            <td class="cell-number cell-tokens" style="font-weight:700;">${formatTokens(d.budgetTokens)}</td>
            <td><div class="cap-dots">${caps || '<span style="color:var(--text-muted);font-size:11px;">None</span>'}</div></td>
          </tr>
          <tr class="detail-row" id="detail-${d.id}" style="display:none;">
            <td colspan="7">
              ${buildDetailPanel(d)}
            </td>
          </tr>`;
      }).join('');
    }

    // ===== DETAIL PANEL =====
    function buildDetailPanel(d) {
      const costPerToken = d.outputPrice > 0 ? (d.outputPrice / 1000000) : 0;
      const inputBudget = d.inputPrice > 0 ? formatTokens((DIEM_BUDGET / d.inputPrice) * 1000000) : 'N/A';
      const outputBudget = d.outputPrice > 0 ? formatTokens((DIEM_BUDGET / d.outputPrice) * 1000000) : 'N/A';

      return `
        <div class="detail-panel">
          <div class="detail-card">
            <h5>Token Limits</h5>
            <div class="detail-stat">
              <span class="detail-stat-label">Context Window</span>
              <span class="detail-stat-value" style="color:var(--indigo);">${d.contextTokens.toLocaleString()}</span>
            </div>
            <div class="detail-stat">
              <span class="detail-stat-label">Max Output Tokens</span>
              <span class="detail-stat-value">${d.maxOutputTokens.toLocaleString()}</span>
            </div>
            <div class="detail-stat">
              <span class="detail-stat-label">Effective Input</span>
              <span class="detail-stat-value">${(d.contextTokens - d.maxOutputTokens).toLocaleString()}</span>
            </div>
          </div>
          <div class="detail-card">
            <h5>Pricing Details</h5>
            <div class="detail-stat">
              <span class="detail-stat-label">Input / 1M tokens</span>
              <span class="detail-stat-value ${getPriceClass(d.inputPrice)}">$${d.inputPrice.toFixed(4)}</span>
            </div>
            <div class="detail-stat">
              <span class="detail-stat-label">Output / 1M tokens</span>
              <span class="detail-stat-value ${getPriceClass(d.outputPrice)}">$${d.outputPrice.toFixed(4)}</span>
            </div>
            <div class="detail-stat">
              <span class="detail-stat-label">Cost / token (out)</span>
              <span class="detail-stat-value">$${costPerToken.toFixed(8)}</span>
            </div>
          </div>
          <div class="detail-card">
            <h5>$48 Budget Analysis</h5>
            <div class="detail-stat">
              <span class="detail-stat-label">Max Input Tokens</span>
              <span class="detail-stat-value" style="color:var(--green);">${inputBudget}</span>
            </div>
            <div class="detail-stat">
              <span class="detail-stat-label">Max Output Tokens</span>
              <span class="detail-stat-value" style="color:var(--green);">${outputBudget}</span>
            </div>
            <div class="detail-stat">
              <span class="detail-stat-label">Approx Conversations*</span>
              <span class="detail-stat-value">${d.budgetTokens > 0 ? Math.floor(d.budgetTokens / 2000).toLocaleString() : 'N/A'}</span>
            </div>
          </div>
          <div class="detail-card">
            <h5>All Capabilities</h5>
            <div class="detail-stat">
              <span class="detail-stat-label">Reasoning</span>
              <span class="detail-stat-value">${d.reasoning ? '<span style="color:var(--violet);">Yes</span>' : '<span style="color:var(--text-muted);">No</span>'}</span>
            </div>
            <div class="detail-stat">
              <span class="detail-stat-label">Vision</span>
              <span class="detail-stat-value">${d.vision ? '<span style="color:var(--blue);">Yes</span>' : '<span style="color:var(--text-muted);">No</span>'}</span>
            </div>
            <div class="detail-stat">
              <span class="detail-stat-label">Code Optimized</span>
              <span class="detail-stat-value">${d.code ? '<span style="color:var(--green);">Yes</span>' : '<span style="color:var(--text-muted);">No</span>'}</span>
            </div>
            <div class="detail-stat">
              <span class="detail-stat-label">Web Search</span>
              <span class="detail-stat-value">${d.websearch ? '<span style="color:var(--cyan);">Yes</span>' : '<span style="color:var(--text-muted);">No</span>'}</span>
            </div>
            <div class="detail-stat">
              <span class="detail-stat-label">Function Calling</span>
              <span class="detail-stat-value">${d.functions ? '<span style="color:var(--orange);">Yes</span>' : '<span style="color:var(--text-muted);">No</span>'}</span>
            </div>
            <div class="detail-stat">
              <span class="detail-stat-label">JSON Schema</span>
              <span class="detail-stat-value">${d.schema ? '<span style="color:var(--pink);">Yes</span>' : '<span style="color:var(--text-muted);">No</span>'}</span>
            </div>
            <div class="detail-stat">
              <span class="detail-stat-label">Beta</span>
              <span class="detail-stat-value">${d.beta ? '<span style="color:var(--amber);">Yes</span>' : '<span style="color:var(--text-muted);">No</span>'}</span>
            </div>
          </div>
        </div>
        <div style="padding:0 20px 8px;font-size:10px;color:var(--text-muted);">*Approx conversations assumes ~2K output tokens per conversation</div>
      `;
    }

    function toggleDetail(modelId) {
      const row = document.getElementById('detail-' + modelId);
      if (!row) return;

      if (expandedRow && expandedRow !== modelId) {
        const prev = document.getElementById('detail-' + expandedRow);
        if (prev) prev.style.display = 'none';
      }

      if (row.style.display === 'none') {
        row.style.display = 'table-row';
        expandedRow = modelId;
      } else {
        row.style.display = 'none';
        expandedRow = null;
      }
    }

    // ===== COLLAPSIBLE SECTIONS =====
    function toggleCollapsible(header) {
      header.classList.toggle('open');
      const body = header.nextElementSibling;
      body.classList.toggle('open');
    }

    // ===== RATE LIMITS =====
    async function fetchRateLimits() {
      const apiKey = getApiKey();
      if (!apiKey) return;

      try {
        const response = await fetch(`${BASE_URL}/api_keys/rate_limits`, {
          headers: { 'Authorization': `Bearer ${apiKey}` }
        });
        if (!response.ok) return;

        const data = await response.json();
        if (data) {
          const rpm = data.requests_per_minute || data.rpm || '--';
          const tpm = data.tokens_per_minute || data.tpm || '--';
          const rpd = data.requests_per_day || data.rpd || '--';
          const tpd = data.tokens_per_day || data.tpd || '--';

          document.getElementById('rpmLimit').textContent = typeof rpm === 'number' ? rpm.toLocaleString() : rpm;
          document.getElementById('tpmLimit').textContent = typeof tpm === 'number' ? formatTokens(tpm) : tpm;
          document.getElementById('rpdLimit').textContent = typeof rpd === 'number' ? rpd.toLocaleString() : rpd;
          document.getElementById('tpdLimit').textContent = typeof tpd === 'number' ? formatTokens(tpd) : tpd;
        }
      } catch (error) {
        console.warn('Error fetching rate limits:', error);
      }
    }

    // ===== EXPORT CSV =====
    function exportCSV() {
      if (filteredModels.length === 0) return;

      const headers = ['Model', 'Context Tokens', 'Max Output', 'Input $/1M', 'Output $/1M', 'Tokens @ $48', 'Reasoning', 'Vision', 'Code', 'Web Search', 'Functions', 'JSON Schema', 'Beta'];
      const rows = filteredModels.map(m => {
        const d = getModelData(m);
        return [
          d.name, d.contextTokens, d.maxOutputTokens,
          d.inputPrice.toFixed(4), d.outputPrice.toFixed(4),
          Math.round(d.budgetTokens),
          d.reasoning ? 'Yes' : 'No',
          d.vision ? 'Yes' : 'No',
          d.code ? 'Yes' : 'No',
          d.websearch ? 'Yes' : 'No',
          d.functions ? 'Yes' : 'No',
          d.schema ? 'Yes' : 'No',
          d.beta ? 'Yes' : 'No'
        ].join(',');
      });

      const csv = [headers.join(','), ...rows].join('\n');
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'venice-models-' + new Date().toISOString().split('T')[0] + '.csv';
      a.click();
      URL.revokeObjectURL(url);
    }

    // ===== REFRESH =====
    function refreshData() {
      document.getElementById('loadingOverlay').style.display = 'flex';
      document.getElementById('loadingOverlay').innerHTML = `
        <div class="loading-spinner"></div>
        <div class="loading-text">Refreshing data...</div>
      `;
      fetchModels();
    }

    // ===== LOGOUT =====
    function logout() {
      if (confirm('Are you sure you want to sign out?')) {
        localStorage.removeItem('venice_password');
        localStorage.removeItem('venice_user_api_key');
        localStorage.removeItem('venice_backend_api_key');
        window.location.href = 'index.html';
      }
    }

    // ===== KEYBOARD SHORTCUT =====
    document.addEventListener('keydown', (e) => {
      // Ctrl/Cmd + K to focus search
      if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
        e.preventDefault();
        document.getElementById('searchInput').focus();
      }
      // Escape to clear search
      if (e.key === 'Escape') {
        const input = document.getElementById('searchInput');
        if (document.activeElement === input) {
          input.value = '';
          input.blur();
          applyFilters();
        }
      }
    });

    // ===== INIT =====
    document.addEventListener('DOMContentLoaded', fetchModels);
  </script>
</body>

</html>
